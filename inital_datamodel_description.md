# Текущая модель данных

## Схема текущей модели данных

![Схема текущей модели данных](data/initial_datamodel_er.png)

## Описание полей таблицы лога `public.shipping`

+ `shippingid` — уникальный идентификатор доставки.
+ `saleid` — уникальный идентификатор заказа. К одному заказу может быть привязано несколько строчек `shippingid`, то есть логов, с информацией о доставке.
+ `vendorid` — уникальный идентификатор вендора. К одному вендору может быть привязано множество `saleid` и множество строк доставки.
+ `payment` — сумма платежа (то есть дублирующаяся информация).
+ `shipping_plan_datetime` — плановая дата доставки.
+ `status` — статус доставки в таблице `shipping` по-данному `shippingid`. Может принимать значения `in_progress` — доставка в процессе, либо `finished` — доставка завершена.
+ `state` — промежуточные точки заказа, которые изменяются в соответствии с обновлением информации о доставке по времени `state_datetime`:
    + `booked` (пер. «заказано»);
    + `fulfillment` — заказ доставлен на склад отправки;
    + `queued` (пер. «в очереди») — заказ в очереди на запуск доставки;
    + `transition` (пер. «передача») — запущена доставка заказа;
    + `pending` (пер. «в ожидании») — заказ доставлен в пункт выдачи и ожидает получения;
    + `received` (пер. «получено») — покупатель забрал заказ;
    + `returned` (пер. «возвращено») — покупатель возвратил заказ после того, как его забрал.
+ `state_datetime` — время обновления состояния заказа.
+ `shipping_transfer_description` — строка со значениями `transfer_type` и `transfer_model`, записанными через `:`. Пример записи — `1p:car`.
+ `transfer_type` — тип доставки. `1p` означает, что компания берёт ответственность за доставку на себя, `3p` — что за отправку ответственен вендор.
+ `transfer_model` — модель доставки, то есть способ, которым заказ доставляется до пункта назначения: `car` — машиной, `train` — поездом, `ship` — кораблем, `airplane` — самолетом, `multiple` — комбинированной доставкой.
+ `shipping_transfer_rate` — процент стоимости доставки для вендора в зависимости от типа и модели доставки, который взимается интернет-магазином для покрытия расходов.
+ `shipping_country` — страна доставки.
+ `shipping_country_base_rate` — налог на доставку в страну, который является процентом от стоимости `payment_amount`.
+ `vendor_agreement_description` — строка, в которой содержатся данные `agreementid`, `agreement_number`, `agreement_rate`, `agreement_commission`, записанные через разделитель `:`. Пример записи — `12:vsp-34:0.02:0.023`.
+ `agreementid` — идентификатор договора. `agreement_number` — номер договора в бухгалтерии. `agreement_rate` — ставка налога за стоимость доставки товара для вендора. `agreement_commission` — комиссия, то есть доля в платеже являющаяся доходом компании от сделки.
